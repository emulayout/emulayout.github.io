<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<script>
			(function () {
				const stored = localStorage.getItem('theme');
				const dark = stored
					? stored === 'dark'
					: window.matchMedia('(prefers-color-scheme: dark)').matches;
				if (dark) {
					document.documentElement.classList.add('dark');
				}
			})();
		</script>
		<style>
			/* Set background-color immediately based on dark class to prevent flash */
			html:not(.dark) body {
				background-color: #faf9f7 !important;
			}
			html.dark body {
				background-color: #141210 !important;
			}
			/* Prevent background-color transition on initial load */
			body:not(.theme-loaded) {
				transition: none !important;
			}
		</style>
		<script>
			// Enable transitions after initial render
			// Use requestAnimationFrame for modern, performant timing
			requestAnimationFrame(() => {
				requestAnimationFrame(() => {
					// Double RAF ensures CSS has been applied
					if (document.body) {
						document.body.classList.add('theme-loaded');
					}
				});
			});
		</script>
		%sveltekit.head%
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents">%sveltekit.body%</div>
	</body>
</html>
